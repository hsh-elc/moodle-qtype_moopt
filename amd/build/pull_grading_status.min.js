define("qtype_moopt/pull_grading_status",["core/ajax","core/modal_save_cancel","core/modal_events","core/str"],(function(ajax,SaveCancelModal,ModalEvents,Strings){var timer,qubaid,isCurrentlyShowingModal=!1;function checkGradingFinished(){ajax.call([{methodname:"qtype_moopt_service_retrieve_grading_results",args:{qubaid:qubaid},done:function(result){result.estimatedSecondsRemainingForEachQuestion.forEach((function(estimatedSecondsRemainingForOneQuestion){let elems=document.getElementsByClassName("estimatedSecondsRemaining_"+estimatedSecondsRemainingForOneQuestion.questionId);Array.from(elems).forEach((function(div){"none"===div.style.display&&(div.style.display="block")})),elems=document.getElementsByClassName("estimatedSecondsRemainingValue_"+estimatedSecondsRemainingForOneQuestion.questionId),Array.from(elems).forEach((function(elem){elem.innerHTML=estimatedSecondsRemainingForOneQuestion.estimatedSecondsRemaining}))})),result.finished&&function(){if(isCurrentlyShowingModal)return;isCurrentlyShowingModal=!0;var strings=[{key:"reloadpage",component:"qtype_moopt"},{key:"gradeprocessfinished",component:"qtype_moopt"},{key:"reload",component:"qtype_moopt"}];Strings.get_strings(strings).then((values=>{SaveCancelModal.create({title:values[0],body:values[1],show:!0,removeOnClose:!0,buttons:{save:values[2]}}).then((modal=>{modal.getRoot().on(ModalEvents.save,(()=>{location.reload(!0)}))}))}))}()},fail:function(errorObject){console.log(errorObject)}}])}return{init:function(qubaid_param,slot,polling_interval){document.querySelectorAll("input[name='redoslot"+slot+"'").forEach((function(elem){elem.remove()})),qubaid=qubaid_param,void 0===timer&&(timer=setInterval(checkGradingFinished,polling_interval))}}}));

//# sourceMappingURL=pull_grading_status.min.js.map